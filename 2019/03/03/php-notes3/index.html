<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Kevin W build this air-castle to collect infos &amp; photos"><title>PHP &amp; MySQL learning notes (4) | MonoShow</title><link rel="stylesheet" type="text/css" href="../../../../css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="../../../../favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="../../../../favicon.ico"><link rel="apple-touch-icon" href="../../../../apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="../../../../apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="../../../../atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">PHP &amp; MySQL learning notes (4)</h1><a id="logo" href="../../../../.">MonoShow</a><p class="description">Monologue from kevin</p></div><div id="nav-menu"><a class="current" href="../../../../."><i class="fa fa-home"> 首页</i></a><a href="../../../../archives/"><i class="fa fa-archive"> 归档</i></a><a href="../../../../photo/"><i class="fa fa-camera"> photo</i></a><a href="../../../../about/"><i class="fa fa-user"> 关于我</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">PHP &amp; MySQL learning notes (4)</h1><div class="post-meta">Mar 3, 2019<span> | </span><span class="category"><a href="../../../../categories/study/">study</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.8k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 17</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#连接MySQL"><span class="toc-number">1.</span> <span class="toc-text">连接MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建连接"><span class="toc-number">1.1.</span> <span class="toc-text">创建连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关闭链接"><span class="toc-number">1.2.</span> <span class="toc-text">关闭链接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建数据库"><span class="toc-number">2.</span> <span class="toc-text">创建数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建数据表-CREATE"><span class="toc-number">3.</span> <span class="toc-text">创建数据表 CREATE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插入数据-INSERT"><span class="toc-number">4.</span> <span class="toc-text">插入数据 INSERT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#插入单条数据"><span class="toc-number">4.1.</span> <span class="toc-text">插入单条数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插入多条数据"><span class="toc-number">4.2.</span> <span class="toc-text">插入多条数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用预处理语句优化"><span class="toc-number">4.3.</span> <span class="toc-text">使用预处理语句优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询数据-SELECT"><span class="toc-number">5.</span> <span class="toc-text">查询数据 SELECT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#简单查询"><span class="toc-number">5.1.</span> <span class="toc-text">简单查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改数据-UPDATE"><span class="toc-number">6.</span> <span class="toc-text">修改数据 UPDATE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除数据-DELETE"><span class="toc-number">7.</span> <span class="toc-text">删除数据 DELETE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用的类和函数汇总"><span class="toc-number">8.</span> <span class="toc-text">使用的类和函数汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqli-PHP和Mysql数据库之间的一个连接"><span class="toc-number">8.1.</span> <span class="toc-text">mysqli PHP和Mysql数据库之间的一个连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqli-stmt-预编译-SQL-语句"><span class="toc-number">8.2.</span> <span class="toc-text">mysqli_stmt 预编译 SQL 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysqli-result-从一个数据库查询中获取的结果集"><span class="toc-number">8.3.</span> <span class="toc-text">mysqli_result 从一个数据库查询中获取的结果集</span></a></li></ol></li></ol></div></div><div class="post-content"><p>由于PHP和MySQL版本问题，对 <a href="https://hyqskevin.github.io/2018/10/28/w3school-php/#3-mySQL">PHP &amp; MySQL learning notes (1)</a> 中曾经写过用的PHP操作MySQL数据库进行笔记更新<br>完善 <a href="https://hyqskevin.github.io/2019/01/21/php-notes2/#MySQL">PHP &amp; MySQL learning notes (3)</a> 中的代码<br>重新用 MySQLi (面向对象) MySQLi (面向过程) PDO 三种方式演示PHP操作MySQL<br><a id="more"></a></p>
<p>可以通过 phpinfo() 查看 mysqli 和 PDO 是否可以使用</p>
<h2 id="连接MySQL"><a href="#连接MySQL" class="headerlink" title="连接MySQL"></a>连接MySQL</h2><h3 id="创建连接"><a href="#创建连接" class="headerlink" title="创建连接"></a>创建连接</h3><p>面向对象</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = <span class="keyword">new</span> mysqli($servername, $username, $password);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . $conn-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"连接成功"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>面向过程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = mysqli_connect($servername, $username, $password);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (!$conn) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"连接成功"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;"</span>, $username, $password);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"连接成功"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="关闭链接"><a href="#关闭链接" class="headerlink" title="关闭链接"></a>关闭链接</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$conn-&gt;close();  <span class="comment">//面向对象</span></span><br><span class="line">mysqli_close($conn);  <span class="comment">//面向过程</span></span><br><span class="line">$conn = <span class="keyword">null</span>;  <span class="comment">//实例PDO</span></span><br></pre></td></tr></table></figure>
<h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><p>面向对象</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = <span class="keyword">new</span> mysqli($servername, $username, $password);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . $conn-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库</span></span><br><span class="line">$sql = <span class="string">"CREATE DATABASE myDatabase"</span>;</span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;query($sql) === <span class="keyword">TRUE</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"数据库创建成功"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error creating database: "</span> . $conn-&gt;error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>面向过程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = mysqli_connect($servername, $username, $password);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (!$conn) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库</span></span><br><span class="line">$sql = <span class="string">"CREATE DATABASE myDatabase"</span>;</span><br><span class="line"><span class="keyword">if</span> (mysqli_query($conn, $sql)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"数据库创建成功"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error creating database: "</span> . mysqli_error($conn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername"</span>, $username, $password);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置 PDO 错误模式为异常</span></span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line">    $sql = <span class="string">"CREATE DATABASE myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 exec() ，因为没有结果返回</span></span><br><span class="line">    $conn-&gt;exec($sql);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"数据库创建成功&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> $sql . <span class="string">"&lt;br&gt;"</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="创建数据表-CREATE"><a href="#创建数据表-CREATE" class="headerlink" title="创建数据表 CREATE"></a>创建数据表 CREATE</h2><p>创建Mytest表</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Mytest (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">INT</span>(<span class="number">6</span>) <span class="keyword">UNSIGNED</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    firstname <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    lastname <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    email <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    reg_date <span class="built_in">TIMESTAMP</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>面向对象</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabase"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = <span class="keyword">new</span> mysqli($servername, $username, $password, $dbname);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . $conn-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 sql 创建数据表</span></span><br><span class="line">$sql = <span class="string">"CREATE TABLE Mytest (</span></span><br><span class="line"><span class="string">id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">firstname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">lastname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">email VARCHAR(50),</span></span><br><span class="line"><span class="string">reg_date TIMESTAMP</span></span><br><span class="line"><span class="string">)"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;query($sql) === <span class="keyword">TRUE</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Table Mytest</span></span><br><span class="line"><span class="string">   created successfully"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"创建数据表错误: "</span> . $conn-&gt;error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>面向过程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabase"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = mysqli_connect($servername, $username, $password, $dbname);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (!$conn) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 sql 创建数据表</span></span><br><span class="line">$sql = <span class="string">"CREATE TABLE Mytest (</span></span><br><span class="line"><span class="string">id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">firstname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">lastname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">email VARCHAR(50),</span></span><br><span class="line"><span class="string">reg_date TIMESTAMP</span></span><br><span class="line"><span class="string">)"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mysqli_query($conn, $sql)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"数据表 Mytest</span></span><br><span class="line"><span class="string">   创建成功"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"创建数据表错误: "</span> . mysqli_error($conn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;dbname=$dbname"</span>, $username, $password);</span><br><span class="line">    <span class="comment">// 设置 PDO 错误模式，用于抛出异常</span></span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 sql 创建数据表</span></span><br><span class="line">    $sql = <span class="string">"CREATE TABLE MyTest</span></span><br><span class="line"><span class="string">   (</span></span><br><span class="line"><span class="string">    id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">    firstname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">    lastname VARCHAR(30) NOT NULL,</span></span><br><span class="line"><span class="string">    email VARCHAR(50),</span></span><br><span class="line"><span class="string">    reg_date TIMESTAMP</span></span><br><span class="line"><span class="string">    )"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 exec() ，没有结果返回</span></span><br><span class="line">    $conn-&gt;exec($sql);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"数据表 MyTest</span></span><br><span class="line"><span class="string">   创建成功"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> $sql . <span class="string">"&lt;br&gt;"</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="插入数据-INSERT"><a href="#插入数据-INSERT" class="headerlink" title="插入数据 INSERT"></a>插入数据 INSERT</h2><p>使用INSERT进行插入操作</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (column1, column2, column3,...)</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3,...)</span><br></pre></td></tr></table></figure>
<h3 id="插入单条数据"><a href="#插入单条数据" class="headerlink" title="插入单条数据"></a>插入单条数据</h3><p>面向对象</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabase"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = <span class="keyword">new</span> mysqli($servername, $username, $password, $dbname);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"连接失败: "</span> . $conn-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"INSERT INTO MyTest (firstname, lastname, email)</span></span><br><span class="line"><span class="string">VALUES ('John', 'Doe', 'john@example.com')"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($conn-&gt;query($sql) === <span class="keyword">TRUE</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error: "</span> . $sql . <span class="string">"&lt;br&gt;"</span> . $conn-&gt;error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>面向过程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabase"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建连接</span></span><br><span class="line">$conn = mysqli_connect($servername, $username, $password, $dbname);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (!$conn) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"INSERT INTO MyTest (firstname, lastname, email)</span></span><br><span class="line"><span class="string">VALUES ('John', 'Doe', 'john@example.com')"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mysqli_query($conn, $sql)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error: "</span> . $sql . <span class="string">"&lt;br&gt;"</span> . mysqli_error($conn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;dbname=$dbname"</span>, $username, $password);</span><br><span class="line">    <span class="comment">// 设置 PDO 错误模式，用于抛出异常</span></span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line">    $sql = <span class="string">"INSERT INTO MyTest</span></span><br><span class="line"><span class="string">   (firstname, lastname, email)</span></span><br><span class="line"><span class="string">    VALUES ('John', 'Doe', 'john@example.com')"</span>;</span><br><span class="line">    <span class="comment">// 使用 exec() ，没有结果返回</span></span><br><span class="line">    $conn-&gt;exec($sql);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    $conn-&gt;exec("INSERT INTO MyTest</span></span><br><span class="line"><span class="comment">   (firstname, lastname, email)</span></span><br><span class="line"><span class="comment">    VALUES ('John', 'Doe', 'john<span class="doctag">@example</span>.com')")</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> $sql . <span class="string">"&lt;br&gt;"</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="插入多条数据"><a href="#插入多条数据" class="headerlink" title="插入多条数据"></a>插入多条数据</h3><p>mysqli_multi_query() 函数可用来执行多条SQL语句</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$sql = <span class="string">"INSERT INTO MyTest (firstname, lastname, email)</span></span><br><span class="line"><span class="string">VALUES ('John', 'Doe', 'john@example.com');"</span>;</span><br><span class="line">$sql .= <span class="string">"INSERT INTO MyTest (firstname, lastname, email)</span></span><br><span class="line"><span class="string">VALUES ('Mary', 'Moe', 'mary@example.com');"</span>;</span><br><span class="line">$sql .= <span class="string">"INSERT INTO MyTest (firstname, lastname, email)</span></span><br><span class="line"><span class="string">VALUES ('Julie', 'Dooley', 'julie@example.com')"</span>;</span><br><span class="line"></span><br><span class="line">$conn-&gt;multi_query($sql) === <span class="keyword">TRUE</span> <span class="comment">// 面向对象</span></span><br><span class="line">mysqli_multi_query($conn, $sql)  <span class="comment">//面向过程</span></span><br></pre></td></tr></table></figure>
<p>PDO需要使用事务函数执行多条并提交，执行失败后要使用回滚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;dbname=$dbname"</span>, $username, $password);</span><br><span class="line">    <span class="comment">// set the PDO error mode to exception</span></span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始事务</span></span><br><span class="line">    $conn-&gt;beginTransaction();</span><br><span class="line">    <span class="comment">// SQL 语句</span></span><br><span class="line">    $conn-&gt;exec(<span class="string">"INSERT INTO MyTest</span></span><br><span class="line"><span class="string">   (firstname, lastname, email)</span></span><br><span class="line"><span class="string">    VALUES ('John', 'Doe', 'john@example.com')"</span>);</span><br><span class="line">    $conn-&gt;exec(<span class="string">"INSERT INTO MyTest</span></span><br><span class="line"><span class="string">   (firstname, lastname, email)</span></span><br><span class="line"><span class="string">    VALUES ('Mary', 'Moe', 'mary@example.com')"</span>);</span><br><span class="line">    $conn-&gt;exec(<span class="string">"INSERT INTO MyTest</span></span><br><span class="line"><span class="string">   (firstname, lastname, email)</span></span><br><span class="line"><span class="string">    VALUES ('Julie', 'Dooley', 'julie@example.com')"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交事务</span></span><br><span class="line">    $conn-&gt;commit();</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 如果执行失败回滚</span></span><br><span class="line">    $conn-&gt;rollback();</span><br><span class="line">    <span class="keyword">echo</span> $sql . <span class="string">"&lt;br&gt;"</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="使用预处理语句优化"><a href="#使用预处理语句优化" class="headerlink" title="使用预处理语句优化"></a>使用预处理语句优化</h3><p>用于执行多个相同的 SQL 语句，也可以防止 MySQL 注入</p>
<p><strong>主要优势</strong></p>
<ol>
<li>预处理语句大大减少了分析时间，只做了一次查询（虽然语句多次执行）</li>
<li>绑定参数减少了服务器带宽，你只需要发送查询的参数，而不是整个语句</li>
<li>预处理语句针对SQL注入是非常有用的，因为参数值发送后使用不同的协议，保证了数据的合法性</li>
</ol>
<p><strong>流程</strong></p>
<ol>
<li>预处理：创建 SQL 语句模板并发送到数据库。预留的值使用参数 <code>?</code> 标记，可以将其替换为整型，字符串，双精度浮点型和布尔值<br><code>INSERT INTO MyTest (firstname, lastname, email) VALUES(?, ?, ?)</code></li>
<li>绑定 SQL 参数并告知相关的值<br><code>$stmt-&gt;bind_param(&quot;sss&quot;, $firstname, $lastname, $email);</code></li>
</ol>
<ul>
<li>“sss” 参数列处理参数的数据类型，参数有以下四种类型:<br>i - integer（整型）<br>d - double（双精度浮点型）<br>s - string（字符串）<br>b - BLOB（binary large object:二进制大对象）</li>
<li>通过告诉数据库参数的数据类型，可以降低 SQL 注入的风险</li>
</ul>
<ol start="3">
<li>数据库解析，编译，对SQL语句模板执行查询优化，并存储结果不输出</li>
<li>执行：最后，将应用绑定的值传递给参数（<code>?</code> 标记），数据库执行语句</li>
</ol>
<p>使用预处理语句插入多条数据</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 检测数据库链接状态 同上</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 预处理及绑定</span></span><br><span class="line">$stmt = $conn-&gt;prepare(<span class="string">"INSERT INTO MyTest (firstname, lastname, email) VALUES (?, ?, ?)"</span>);</span><br><span class="line">$stmt-&gt;bind_param(<span class="string">"sss"</span>, $firstname, $lastname, $email);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置参数并执行</span></span><br><span class="line">$firstname = <span class="string">"John"</span>;</span><br><span class="line">$lastname = <span class="string">"Doe"</span>;</span><br><span class="line">$email = <span class="string">"john@example.com"</span>;</span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">$firstname = <span class="string">"Mary"</span>;</span><br><span class="line">$lastname = <span class="string">"Moe"</span>;</span><br><span class="line">$email = <span class="string">"mary@example.com"</span>;</span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">$firstname = <span class="string">"Julie"</span>;</span><br><span class="line">$lastname = <span class="string">"Dooley"</span>;</span><br><span class="line">$email = <span class="string">"julie@example.com"</span>;</span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line"></span><br><span class="line">$stmt-&gt;close();</span><br><span class="line">$conn-&gt;close();</span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;dbname=$dbname"</span>, $username, $password);</span><br><span class="line">    <span class="comment">// 设置 PDO 错误模式为异常</span></span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 预处理 SQL 并绑定参数</span></span><br><span class="line">    $stmt = $conn-&gt;prepare(<span class="string">"INSERT INTO MyTest</span></span><br><span class="line"><span class="string">   (firstname, lastname, email)</span></span><br><span class="line"><span class="string">    VALUES (:firstname, :lastname, :email)"</span>);</span><br><span class="line">    $stmt-&gt;bindParam(<span class="string">':firstname'</span>, $firstname);</span><br><span class="line">    $stmt-&gt;bindParam(<span class="string">':lastname'</span>, $lastname);</span><br><span class="line">    $stmt-&gt;bindParam(<span class="string">':email'</span>, $email);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 插入行</span></span><br><span class="line">    $firstname = <span class="string">"John"</span>;</span><br><span class="line">    $lastname = <span class="string">"Doe"</span>;</span><br><span class="line">    $email = <span class="string">"john@example.com"</span>;</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 插入其他行</span></span><br><span class="line">    $firstname = <span class="string">"Mary"</span>;</span><br><span class="line">    $lastname = <span class="string">"Moe"</span>;</span><br><span class="line">    $email = <span class="string">"mary@example.com"</span>;</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 插入其他行</span></span><br><span class="line">    $firstname = <span class="string">"Julie"</span>;</span><br><span class="line">    $lastname = <span class="string">"Dooley"</span>;</span><br><span class="line">    $email = <span class="string">"julie@example.com"</span>;</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"新记录插入成功"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error: "</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="查询数据-SELECT"><a href="#查询数据-SELECT" class="headerlink" title="查询数据 SELECT"></a>查询数据 SELECT</h2><h3 id="简单查询"><a href="#简单查询" class="headerlink" title="简单查询"></a>简单查询</h3><p>SELECT 语句用于从数据表中读取数据:<br><code>SELECT column_name(s) FROM table_name</code></p>
<p>面向对象</p>
<ol>
<li>设置 SQL 语句从 MyTest数据表中读取 id, firstname 和 lastname 三个字段。</li>
<li>使用 SQL 语句从数据库中取出结果集并赋给复制给变量 $result。</li>
<li>函数 num_rows() 判断返回的数据。</li>
<li>函数 fetch_assoc() 将结合集放入到关联数组并循环输出</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建和检测连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立索引</span></span><br><span class="line">$sql = <span class="string">"SELECT id, firstname, lastname FROM MyTest"</span>;</span><br><span class="line">$result = $conn-&gt;query($sql);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 输出数据</span></span><br><span class="line">    <span class="keyword">while</span>($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"id: "</span> . $row[<span class="string">"id"</span>]. <span class="string">" - Name: "</span> . $row[<span class="string">"firstname"</span>]. <span class="string">" "</span> . $row[<span class="string">"lastname"</span>]. <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"0 结果"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$conn-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>面向过程</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建并检测连接</span></span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT id, firstname, lastname FROM MyTest"</span>;</span><br><span class="line">$result = mysqli_query($conn, $sql);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mysqli_num_rows($result) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// 输出数据</span></span><br><span class="line">    <span class="keyword">while</span>($row = mysqli_fetch_assoc($result)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"id: "</span> . $row[<span class="string">"id"</span>]. <span class="string">" - Name: "</span> . $row[<span class="string">"firstname"</span>]. <span class="string">" "</span> . $row[<span class="string">"lastname"</span>]. <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"0 结果"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>PDO</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"username"</span>;</span><br><span class="line">$password = <span class="string">"password"</span>;</span><br><span class="line">$dbname = <span class="string">"myDatabasePDO"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $conn = <span class="keyword">new</span> PDO(<span class="string">"mysql:host=$servername;dbname=$dbname"</span>, $username, $password);</span><br><span class="line">    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line">    $stmt = $conn-&gt;prepare(<span class="string">"SELECT id, firstname, lastname FROM MyTest</span></span><br><span class="line"><span class="string">  "</span>);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置结果集为关联数组</span></span><br><span class="line">    $result = $stmt-&gt;setFetchMode(PDO::FETCH_ASSOC);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">new</span> TableRows(<span class="keyword">new</span> RecursiveArrayIterator($stmt-&gt;fetchAll())) <span class="keyword">as</span> $k=&gt;$v) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(PDOException $e) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Error: "</span> . $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">$conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/table&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用 WHERE 子句, ORDER BY 子句进行查询时，必须使用 <code>mysqli::query</code> 或 <code>mysqli_query()</code> ，用于向 MySQL 连接发送查询或命令</li>
</ul>
<h2 id="修改数据-UPDATE"><a href="#修改数据-UPDATE" class="headerlink" title="修改数据 UPDATE"></a>修改数据 UPDATE</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name</span><br><span class="line"><span class="keyword">SET</span> column1=<span class="keyword">value</span>, column2=value2,...</span><br><span class="line"><span class="keyword">WHERE</span> some_column=some_value</span><br></pre></td></tr></table></figure>
<p>必须使用  <code>mysqli::query</code> 或 <code>mysqli_query()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$con=mysqli_connect(<span class="string">"localhost"</span>,<span class="string">"username"</span>,<span class="string">"password"</span>,<span class="string">"database"</span>);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"连接失败: "</span> . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_query($con,<span class="string">"UPDATE Persons SET Age=36</span></span><br><span class="line"><span class="string">WHERE FirstName='Peter' AND LastName='Griffin'"</span>);</span><br><span class="line"></span><br><span class="line">mysqli_close($con);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="删除数据-DELETE"><a href="#删除数据-DELETE" class="headerlink" title="删除数据 DELETE"></a>删除数据 DELETE</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> some_column = some_value</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$con=mysqli_connect(<span class="string">"localhost"</span>,<span class="string">"username"</span>,<span class="string">"password"</span>,<span class="string">"database"</span>);</span><br><span class="line"><span class="comment">// 检测连接</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"连接失败: "</span> . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_query($con,<span class="string">"DELETE FROM Persons WHERE LastName='Griffin'"</span>);</span><br><span class="line"></span><br><span class="line">mysqli_close($con);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="使用的类和函数汇总"><a href="#使用的类和函数汇总" class="headerlink" title="使用的类和函数汇总"></a>使用的类和函数汇总</h2><h3 id="mysqli-PHP和Mysql数据库之间的一个连接"><a href="#mysqli-PHP和Mysql数据库之间的一个连接" class="headerlink" title="mysqli PHP和Mysql数据库之间的一个连接"></a>mysqli PHP和Mysql数据库之间的一个连接</h3><p>mysqli::init — 初始化 MySQLi 并返回一个资源类型的值，这个值可以作为 mysqli_real_connect() 函数的传入参数<br>mysqli::$info — 返回最近执行的 SQL 语句的信息<br>mysqli::stat — 获取当前系统状态信息<br>mysqli::$connect_error/mysqli_connect_error() — 返回最后连接错误描述<br>mysqli::$error/mysqli_error() — 返回最后的错误描述<br>mysqli::__construct/mysqli_connect() — 开始一个新的MySQL服务连接<br>mysqli::real_connect — 建立一个 MySQL 服务器连接<br>mysqli::select_db — 选择用于数据库查询的默认数据库<br>mysqli::query — 对数据库执行一次查询<br>mysqli::real_query — 执行一个mysql查询<br>mysqli::send_query — 发送请求并返回结果<br>mysqli::multi_query — 执行查询<br>mysqli::real_escape_string — 根据当前连接的字符集，对于 SQL 语句中的特殊字符进行转义<br>mysqli::prepare — 准备执行一个 SQL 语句<br>mysqli::stmt_init — 初始化一条语句并返回一个用于mysqli_stmt_prepare(调用)的对象<br>mysqli::rollback — 回退当前事务<br>mysqli::close/mysqli_close() — 关闭先前打开的数据库连接</p>
<p>mysqli::autocommit — 打开或关闭本次数据库连接的自动命令提交事务模式<br>mysqli::change_user — 改变指定数据库连接的用户<br>mysqli::character_set_name — 返回当前数据库连接的默认字符编码<br>mysqli::commit — 提交一个事务<br>mysqli::$connect_errno — 返回最后连接错误代码<br>mysqli::errno — 返回最近函数调用的错误代码<br>mysqli::$error_list — 返回最后命令行执行错误列表<br>mysqli::$field_count — Returns the number of columns for the most recent query<br>mysqli::get_charset — Returns a character set object<br>mysqli::$client_info — 获取 MySQL 客户端信息<br>mysqli_get_client_version — 作为一个整数返回MySQL客户端的版本<br>mysqli::get_connection_stats — 返回客户端连接的统计数据<br>mysqli::$host_info — 返回一个表述使用的连接类型的字符串<br>mysqli::$protocol_version — 返回MySQL使用的协议版本号<br>mysqli::$server_info — 返回MySQL服务器的版本号<br>mysqli::$server_version — 作为一个整数返回MySQL服务器的版本<br>mysqli::get_warnings — Get result of SHOW WARNINGS<br>mysqli::$insert_id — 返回最后一条插入语句产生的自增 ID<br>mysqli::kill — 让服务器杀掉一个 MySQL 线程<br>mysqli::more_results — 检查批量查询中是否还有查询结果<br>mysqli::next_result — 为读取 multi_query 执行之后的下一个结果集做准备<br>mysqli::options — 设置选项<br>mysqli::ping — ping 一个连接，或者如果连接处于断开状态，重新连接<br>mysqli::poll — 轮询连接<br>mysqli::reap_async_query — 获取异步查询的结果<br>mysqli::refresh — 刷新<br>mysqli::release_savepoint — 从当前事务的保存点中移除一个命名保存点<br>mysqli::rpl_query_type — 返回 RPL 查询类型<br>mysqli::savepoint — 在当前事务中增加一个命名保存点<br>mysqli::set_charset — 设置默认字符编码<br>mysqli::set_local_infile_default — 取消用户指定的回调函数<br>mysqli::set_local_infile_handler — 设置 LOAD DATA LOCAL INFILE 命令的回调函数<br>mysqli::$sqlstate — 返回上一次 SQL 操作的 SQLSTATE 错误信息<br>mysqli::store_result — 转移上一次查询返回的结果集<br>mysqli::$thread_id — 返回当前连接的线程 ID<br>mysqli::thread_safe — 返回是否是线程安全的</p>
<h3 id="mysqli-stmt-预编译-SQL-语句"><a href="#mysqli-stmt-预编译-SQL-语句" class="headerlink" title="mysqli_stmt 预编译 SQL 语句"></a>mysqli_stmt 预编译 SQL 语句</h3><p>mysqli_stmt :: prepare - 准备一条SQL语句以便执行<br>mysqli_stmt :: bind_param - 将变量作为参数绑定到预准备语句<br>mysqli_stmt :: __ construct - 构造一个新的mysqli_stmt对象<br>mysqli_stmt :: $ num_rows/mysqli_num_rows() - 返回语句结果集中的行数<br>mysqli_stmt :: $ param_count - 返回给定语句的参数个数<br>mysqli_stmt :: $ errno - 返回最近语句调用的错误代码<br>mysqli_stmt :: $ error_list - 返回上一个执行语句的错误列表<br>mysqli_stmt :: $ error - 返回上一个语句错误的字符串描述<br>mysqli_stmt :: execute - 执行准备好的Query<br>mysqli_stmt :: fetch - 将预准备语句的结果提取到绑定变量中<br>mysqli_stmt :: close - 关闭准备好的语句</p>
<p>mysqli_stmt :: $ affected_rows - 返回上次执行的语句更改，删除或插入的总行数<br>mysqli_stmt :: attr_get - 用于获取语句属性的当前值<br>mysqli_stmt :: attr_set - 用于修改预准备语句的行为<br>mysqli_stmt :: bind_result - 将变量绑定到结果存储的预准备语句<br>mysqli_stmt :: data_seek - 寻找语句结果集中的任意行<br>mysqli_stmt :: fetch - 将预准备语句的结果提取到绑定变量中<br>mysqli_stmt :: $ field_count - 返回给定语句中的字段数<br>mysqli_stmt :: free_result - 释放给定语句句柄的存储结果内存<br>mysqli_stmt :: get_result - 从预准备语句中获取结果集<br>mysqli_stmt :: get_warnings - 获取SHOW WARNINGS的结果<br>mysqli_stmt :: $ insert_id - 获取先前INSERT操作生成的ID<br>mysqli_stmt :: more_results - 检查多个查询是否有更多查询结果<br>mysqli_stmt :: next_result - 从多个查询中读取下一个结果<br>mysqli_stmt :: reset - 重置预准备语句<br>mysqli_stmt :: result_metadata - 从预准备语句返回结果集元数据<br>mysqli_stmt :: send_long_data - 以块为单位发送数据<br>mysqli_stmt :: $ sqlstate - 从前一个语句操作返回SQLSTATE错误<br>mysqli_stmt :: store_result - 从预准备语句中传输结果集</p>
<h3 id="mysqli-result-从一个数据库查询中获取的结果集"><a href="#mysqli-result-从一个数据库查询中获取的结果集" class="headerlink" title="mysqli_result 从一个数据库查询中获取的结果集"></a>mysqli_result 从一个数据库查询中获取的结果集</h3><p>mysqli_result :: fetch_all - 将所有结果行提取为关联数组，数字数组或两者<br>mysqli_result :: fetch_array - 将结果行提取为关联行，数字数组或两者<br>mysqli_result :: fetch_assoc/mysqli_fetch_assoc() - 将结果行作为关联数组获取<br>mysqli_result :: $ lengths - 返回结果集中当前行的列长度<br>mysqli_result :: $ num_rows - 获取结果中的行数</p>
<p>mysqli_result :: $ current_field - 获取结果指针的当前字段偏移量<br>mysqli_result :: data_seek - 将结果指针调整为结果中的任意行<br>mysqli_result :: fetch_field_direct - 获取单个字段的元数据<br>mysqli_result :: fetch_field - 返回结果集中的下一个字段<br>mysqli_result :: fetch_fields - 返回表示结果集中字段的对象数组<br>mysqli_result :: fetch_object - 将结果集的当前行作为对象返回<br>mysqli_result :: fetch_row - 将结果行作为枚举数组<br>mysqli_result :: $ field_count - 获取结果中的字段数<br>mysqli_result :: field_seek - 将结果指针设置为指定的字段偏移量<br>mysqli_result :: free - 释放与结果相关的内存</p>
<hr>
<p>相关链接：<br><a href="https://hyqskevin.github.io/2019/02/15/mysql/">mysql 学习笔记</a><br><a href="https://hyqskevin.github.io/2019/01/21/php-notes2/">PHP &amp; MySQL learning notes (3)</a><br><a href="https://hyqskevin.github.io/2018/10/28/w3school-php/">PHP &amp; MySQL learning notes (1)</a></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>KevinW</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2019/03/03/php-notes3/">https://hyqskevin.github.io/2019/03/03/php-notes3/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</li></ul></div><br><div class="tags"><a href="../../../../tags/php/">php</a><a href="../../../../tags/mysql/">mysql</a></div><div class="post-nav"><a class="next" href="../mysql-function/">mysql_function</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/Adobe/">Adobe</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/notes/">notes</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/others/">others</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/practice/">practice</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/repo/">repo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../categories/study/">study</a><span class="category-list-count">11</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="../../../../tags/bootstrap2-0/" style="font-size: 15px;">bootstrap2.0</a> <a href="../../../../tags/others/" style="font-size: 15px;">others</a> <a href="../../../../tags/Kaggle/" style="font-size: 15px;">Kaggle</a> <a href="../../../../tags/hexo/" style="font-size: 15px;">hexo</a> <a href="../../../../tags/time-series/" style="font-size: 15px;">time_series</a> <a href="../../../../tags/ensemble-learning/" style="font-size: 15px;">ensemble_learning</a> <a href="../../../../tags/bp-nn/" style="font-size: 15px;">bp_nn</a> <a href="../../../../tags/book/" style="font-size: 15px;">book</a> <a href="../../../../tags/php/" style="font-size: 15px;">php</a> <a href="../../../../tags/mysql/" style="font-size: 15px;">mysql</a> <a href="../../../../tags/slam/" style="font-size: 15px;">slam</a> <a href="../../../../tags/Linux-device/" style="font-size: 15px;">Linux_device</a> <a href="../../../../tags/laravel/" style="font-size: 15px;">laravel</a> <a href="../../../../tags/machine-learning/" style="font-size: 15px;">machine_learning</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="">PHP & MySQL learning notes (4)</a></li><li class="post-list-item"><a class="post-list-link" href="../mysql-function/">mysql_function</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/27/migration/">Laravel SQL migration</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/23/mysql-regular/">mysql like子句和正则表达式匹配</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/20/fund-flow/">fund_flow</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/16/book-list/">book-list</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/15/mysql/">mysql 学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="../../../02/14/move-to-windows/">move to windows</a></li><li class="post-list-item"><a class="post-list-link" href="../../../01/21/php-notes2/">PHP & MySQL learning notes (3)</a></li><li class="post-list-item"><a class="post-list-link" href="../../../01/15/ml-api/">Machine Learning API Collection</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="../../../../." rel="nofollow">MonoShow.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="../../../../js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="../../../../js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="../../../../js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="0,0,0" opacity="0.5" zindex="-2" count="50" src="//lib.baomitu.com/canvas-nest.js/2.0.3/canvas-nest.umd.js"></script><script type="text/javascript" src="../../../../js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="../../../../js/smartresize.js?v=0.0.0"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":true},"log":false});</script></body></html>